/** @file
   ZX-E(CHX002) Asia SbDxe library functions : IoeDxeUsb.c

   Copyright (c) 2018 Shanghai Zhaoxin Semiconductor Co., Ltd. 

**/

//**************************************************************************
//**************************************************************************
//**                                                                      **
//**  Copyright (c) 2015 - 2017 Shanghai Zhaoxin Semiconductor Co., Ltd.  **
//**                                                                      **
//**************************************************************************
//**************************************************************************

#include "EfiCommon.h"
//#include "AsiaSbDxe.h"
#include "AsiaIoSaveLib.h"
#include "CHX002Cfg.h"
#include "CHX002Reg.h"
#include EFI_PROTOCOL_DEFINITION(PciHostBridgeResourceAllocation)
#include EFI_PROTOCOL_DEFINITION(PciIo)
#include "EfiDriverLib.h"
#include EFI_GUID_DEFINITION(Hob)
#include "EfiHobLib.h"

#include "EfiBootScript.h"
#include "EfiScriptLib.h"

//#include "Protocol\AsiaSbProtocol\AsiaSbProtocol.h"
//#include "HdAc.h"
#include "AsiaCommon.h" //define ASIA_XXX_CFG_HOB_GUID

#include "IoeDxeUsb.h"

//TTP_IOE_02
#define DIDVID_IOE             0x071F1106
#define DIDVID_IOE_ZX          0x071F1D17

#define DIDVID_IOEXHCI          0x92031106
#define DIDVID_IOEXHCI_ZX       0x92031D17
#define IOEXHCI_DEV             0x12
#define IOEXHCI_FUNC            0x0

  STATIC ASIA_IO_TABLE_6432_REV IOED14Uhci0_Performance_TBL[]={
      {0x00,  0xFF,   (CND003_D14UHC0|0x48),  0x60020000, 0x60000000},
  
      {0xFF,  0x00,   0x00,   0x00,   0x00}
  };
  STATIC ASIA_IO_TABLE_6432_REV IOED14Uhci0_Energy_TBL[]={
      {0x00,  0xFF,   (CND003_D14UHC0|0x48),  0x60020000, 0x60000000},
  
      {0xFF,  0x00,   0x00,   0x00,   0x00}
  };
  STATIC ASIA_IO_TABLE_6432_REV IOED14Uhci1_Performance_TBL[]={
	{0x00,	0xFF,	(CND003_D14UHC1|0x48),	0x60020000,	0x60000000},

	{0xFF,	0x00,	0x00,	0x00,	0x00}
  };
 STATIC ASIA_IO_TABLE_6432_REV IOED14Uhci1_Energy_TBL[]={
	{0x00,	0xFF,	(CND003_D14UHC1|0x48),	0x60020000,	0x60000000},

	{0xFF,	0x00,	0x00,	0x00,	0x00}
};

 STATIC ASIA_IO_TABLE_6432_REV IOED14Uhci2_Performance_TBL[]={
	{0x00,	0xFF,	(CND003_D14UHC2|0x48),	0x60020000,	0x60000000},

	{0xFF,	0x00,	0x00,	0x00,	0x00}
};
STATIC ASIA_IO_TABLE_6432_REV IOED14Uhci2_Energy_TBL[]={
	{0x00,	0xFF,	(CND003_D14UHC2|0x48),	0x60020000,	0x60000000},

	{0xFF,	0x00,	0x00,	0x00,	0x00}
};
  STATIC ASIA_IO_TABLE_6432_REV IOED16Uhci0_Performance_TBL[]={
      {0x00,  0xFF,   (CND003_D16UHC0|0x48),  0x60020000, 0x60000000},
  
      {0xFF,  0x00,   0x00,   0x00,   0x00}
  };
  STATIC ASIA_IO_TABLE_6432_REV IOED16Uhci0_Energy_TBL[]={
      {0x00,  0xFF,   (CND003_D16UHC0|0x48),  0x60020000, 0x60000000},
  
      {0xFF,  0x00,   0x00,   0x00,   0x00}
  };

  STATIC ASIA_IO_TABLE_6432_REV IOED16Uhci1_Performance_TBL[]={
	{0x00,	0xFF,	(CND003_D16UHC1|0x48),	0x60020000,	0x60000000},

	{0xFF,	0x00,	0x00,	0x00,	0x00}
};
STATIC ASIA_IO_TABLE_6432_REV IOED16Uhci1_Energy_TBL[]={
	{0x00,	0xFF,	(CND003_D16UHC1|0x48),	0x60020000,	0x60000000},

	{0xFF,	0x00,	0x00,	0x00,	0x00}
};

  STATIC ASIA_IO_TABLE_6432_REV IOED16Uhci2_Performance_TBL[]={
      {0x00,  0xFF,   (CND003_D16UHC2|0x48),  0x60020000, 0x60000000},
  
      {0xFF,  0x00,   0x00,   0x00,   0x00}
  };
  
  STATIC ASIA_IO_TABLE_6432_REV IOED16Uhci2_Energy_TBL[]={
      {0x00,  0xFF,   (CND003_D16UHC2|0x48),  0x60020000, 0x60000000},
  
      {0xFF,  0x00,   0x00,   0x00,   0x00}
  };


  STATIC ASIA_IO_TABLE_6432_REV IOED14Ehci_Performance_TBL[]={
	{0x00,	0xFF,	(CND003_D14EHCI|0x40),	0x2,	0x2},

	{0x00,	0xFF,	(CND003_D14EHCI|0x48),	0x20,	0x0},

	{0xFF,	0x00,	0x00,	0x00,	0x00}
};
STATIC ASIA_IO_TABLE_6432_REV IOED14Ehci_Energy_TBL[]={
	{0x00,	0xFF,	(CND003_D14EHCI|0x40),	0x2,	0x0},

	{0xFF,	0x00,	0x00,	0x00,	0x00}
};

  STATIC ASIA_IO_TABLE_6432_REV IOED16Ehci_Performance_TBL[]={
      {0x00,  0xFF,   (CND003_D16EHCI|0x40),  0x2,    0x2},
  
      {0x00,  0xFF,   (CND003_D16EHCI|0x48),  0x20,   0x0},
  
      {0x00,  0xFF,   (CND003_D16EHCI|0x64),  0x3200, 0x0200},
  
      {0xFF,  0x00,   0x00,   0x00,   0x00}
  };
  STATIC ASIA_IO_TABLE_6432_REV IOED16Ehci_Energy_TBL[]={
      {0x00,  0xFF,   (CND003_D16EHCI|0x40),  0x2,    0x0},
  
      {0x00,  0xFF,   (CND003_D16EHCI|0x64),  0x3000, 0x0000},
  
      {0xFF,  0x00,   0x00,   0x00,   0x00}
  };
STATIC ASIA_IO_TABLE_6432_REV IOEXhci_Performance_TBL[]= {
 	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTION_BITS_RX43_XHCOPTRX43-3),	0x01000000,	0x01000000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x14},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x40000000,	0x40000000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x18},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x1000,	0x1000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x10c},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x3ff,	0x0},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTION_BITS_RX43_XHCOPTRX43-3),	0x01000000,	0x00000000},

	{0xFF,	0x00,	0x00,	0x00,	0x00}
        };

STATIC ASIA_IO_TABLE_6432_REV IOEXhci_Energy_TBL[]= {
	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTION_BITS_RX43_XHCOPTRX43-3),	0x01000000,	0x01000000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x50},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x777d3f1f,	0x777d3f1f},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x54},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x7f3f05f9,	0x7f3f05f9},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x58},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x5f7f7fff,	0x5f7f7fff},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x5c},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x7fff7f77,	0x7fff7f77},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x78},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x7fffff00,	0x7fffff00},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x7c},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x7fffffff,	0x7fffffff},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x10c},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x3ff,	0x0},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x138},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x1000000,	0x1000000},
	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x13c},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x3ff0000,	0x3ff0000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x10000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x2,	0x2},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x20088},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x4000000,	0x4000000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),	0xFFFFF,	0x2008c},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x10000,	0x10000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20100},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0xffff0000,	0xffff0000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20200},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0xffff0000,	0xffff0000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20300},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0xffff0000,	0xffff0000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20400},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0xffff0000,	0xffff0000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20500},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0xffff0000,	0xffff0000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20104},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x1f0000,	0x1f0000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20204},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x1f0000,	0x1f0000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20304},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x1f0000,	0x1f0000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20404},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x1f0000,	0x1f0000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20504},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x1f0000,	0x1f0000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20114},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x70000,	0x70000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20214},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x70000,	0x70000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20314},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x70000,	0x70000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20414},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x70000,	0x70000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20514},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x70000,	0x70000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20118},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x6,	0x6},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20218},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x6,	0x6},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20318},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x6,	0x6},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20418},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x6,	0x6},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20518},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x6,	0x6},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20180},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x6400200,	0x6400200},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20280},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x6400200,	0x6400200},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20380},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x6400200,	0x6400200},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20480},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x6400200,	0x6400200},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20580},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x6400200,	0x6400200},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20184},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x200,	0x200},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20284},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x200,	0x200},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20384},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x200,	0x200},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20484},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x200,	0x200},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x20584},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x200,	0x200},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x201b0},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x9000,	0x9000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x202b0},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x9000,	0x9000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x203b0},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x9000,	0x9000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x204b0},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x9000,	0x9000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_ADR),		0xFFFFF,	0x205b0},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTIONAL_BITS_CFG_DATA),	0x9000,	0x9000},

	{0x00,	0xFF,	(CND003_XHCI|CND003_D18F0_XHCI_OPTION_BITS_RX43_XHCOPTRX43-3),	0x01000000,	0x00000000},

	{0xFF,	0x00,	0x00,	0x00,	0x00}

};
  
  
  
  //TTP_IOE_02
  /**
  Function description.
  
  @param  PeiServices	EFI_PEI_SERVICES pointer.
  @param SbCfg Point to ASIA_SB_CONFIGURATION struct.

  @return EFI_STATUS.

**/
  EFI_STATUS
  EFIAPI
  IOEUsbSpeInit(
	  IN UINT8	 IOEXhciSpe,
	  IN UINT8	 IOEEhciSpe,
	  IN UINT8	 IOEUhciSpe
  )
  {
	 if(IOEUhciSpe >= DEVICE_SPE_VALUE_PERFORMANCE)
	  {
		  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED16Uhci0_Performance_TBL, sizeof(IOED16Uhci0_Performance_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED16Uhci1_Performance_TBL, sizeof(IOED16Uhci1_Performance_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED16Uhci2_Performance_TBL, sizeof(IOED16Uhci2_Performance_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED14Uhci0_Performance_TBL, sizeof(IOED14Uhci0_Performance_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED14Uhci1_Performance_TBL, sizeof(IOED14Uhci1_Performance_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED14Uhci2_Performance_TBL, sizeof(IOED14Uhci2_Performance_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  if(IOEUhciSpe == DEVICE_SPE_VALUE_ENERGY)
		  {  
			  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED16Uhci0_Energy_TBL, sizeof(IOED16Uhci0_Energy_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
			  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED16Uhci1_Energy_TBL, sizeof(IOED16Uhci1_Energy_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
			  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED16Uhci2_Energy_TBL, sizeof(IOED16Uhci2_Energy_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
			  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED14Uhci0_Energy_TBL, sizeof(IOED14Uhci0_Energy_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
			  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED14Uhci1_Energy_TBL, sizeof(IOED14Uhci1_Energy_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
			  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED14Uhci2_Energy_TBL, sizeof(IOED14Uhci2_Energy_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  }
	  }
	  if(IOEEhciSpe >= DEVICE_SPE_VALUE_PERFORMANCE)
	  {
		  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED16Ehci_Performance_TBL, sizeof(IOED16Ehci_Performance_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED14Ehci_Performance_TBL, sizeof(IOED14Ehci_Performance_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  if(IOEEhciSpe == DEVICE_SPE_VALUE_ENERGY)
		  {
			  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED16Ehci_Energy_TBL, sizeof(IOED16Ehci_Energy_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
			  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOED14Ehci_Energy_TBL, sizeof(IOED14Ehci_Energy_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  }
	  }
	  if(IOEXhciSpe >= DEVICE_SPE_VALUE_PERFORMANCE)
	  {
		  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOEXhci_Performance_TBL, sizeof(IOEXhci_Performance_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  if(IOEXhciSpe == DEVICE_SPE_VALUE_ENERGY)
		  {
			  IOE_PROCESS_SB_R6432M_TABLE_SAVE(IOEXhci_Energy_TBL, sizeof(IOEXhci_Energy_TBL)/sizeof(ASIA_IO_TABLE_6432_REV));
		  }
	  }
	return EFI_SUCCESS;
  }

  /**
  Function description.
  
  @param  PeiServices	EFI_PEI_SERVICES pointer.
  @param SbCfg Point to ASIA_SB_CONFIGURATION struct.

  @return EFI_STATUS.

**/
  EFI_STATUS
  EFIAPI
  IOEUsbDxeInit(
	ASIA_SB_CONFIGURATION* SbCfg 
  )
  {
      UINT8 IOEXhciSpe; //TTP_IOE_02
      UINT8 IOEEhciSpe; //TTP_IOE_02
      UINT8 IOEUhciSpe; //TTP_IOE_02

	if(!IoeExist()){
		DEBUG((EFI_D_ERROR, "[CJW_IOE] SKIP CND003 Init [IOEUsbDxeInit()]\n"));
		return EFI_SUCCESS;
	}
	  
	  DEBUG((EFI_D_ERROR, "[TTP_IOE_USB]: CND003 USB DXE Initialize Start\n"));
	  switch(SbCfg->IOESPEValue)
    {
    case CHIP_SPE_VALUE_MANUAL:
        IOEXhciSpe = SbCfg->IOEXHCISPEValue; //TTP_IOE_02
        IOEEhciSpe = SbCfg->IOEEHCISPEValue; //TTP_IOE_02
        IOEUhciSpe = SbCfg->IOEUHCISPEValue; //TTP_IOE_02
        break;
    case CHIP_SPE_VALUE_STABLE:
        IOEXhciSpe = DEVICE_SPE_VALUE_STABLE; //TTP_IOE_02
        IOEEhciSpe = DEVICE_SPE_VALUE_STABLE; //TTP_IOE_02
        IOEUhciSpe = DEVICE_SPE_VALUE_STABLE; //TTP_IOE_02
        break;
    case CHIP_SPE_VALUE_PERFORMANCE:
        IOEXhciSpe = DEVICE_SPE_VALUE_PERFORMANCE;//TTP_IOE_02
        IOEEhciSpe = DEVICE_SPE_VALUE_PERFORMANCE;//TTP_IOE_02
        IOEUhciSpe = DEVICE_SPE_VALUE_PERFORMANCE;//TTP_IOE_02
        break;
    case CHIP_SPE_VALUE_ENERGY:
        IOEXhciSpe = DEVICE_SPE_VALUE_ENERGY;//TTP_IOE_02
        IOEEhciSpe = DEVICE_SPE_VALUE_ENERGY;//TTP_IOE_02
        IOEUhciSpe = DEVICE_SPE_VALUE_ENERGY;//TTP_IOE_02
        break;
    default:
        IOEXhciSpe = DEVICE_SPE_VALUE_STABLE;//TTP_IOE_02
        IOEEhciSpe = DEVICE_SPE_VALUE_STABLE;//TTP_IOE_02
        IOEUhciSpe = DEVICE_SPE_VALUE_STABLE;//TTP_IOE_02
    }
	  //Enumerate IOE temp
	IoeDxeTempAssignment();
	IOEUsbSpeInit(IOEXhciSpe,IOEEhciSpe,IOEUhciSpe);
			//Function Enable/Disable
		  //
		  //Clear bus number assignment
		  //
	  IoeDxeClearTempAssignment();
	  DEBUG((EFI_D_ERROR, "[TTP_IOE_XHCI]: CND003 USB Initialize End\n"));
	  return EFI_SUCCESS;
  }

