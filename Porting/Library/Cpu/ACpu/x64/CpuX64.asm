;//**********************************************************************
;//**********************************************************************
;//**                                                                  **
;//**     Copyright (c) 2018 Shanghai Zhaoxin Semiconductor Co., Ltd.  **
;//**                                                                  **
;//**********************************************************************
;//**********************************************************************
  title   CpuIoAccess.asm
  
.CODE

;------------------------------------------------------------------------------
;  UINT64
;  GetPState (
;    UINT32  MsrIndex,    // rcx
;    UINT8   Indexer     // rdx
;    )
;------------------------------------------------------------------------------
GetPState PROC            PUBLIC
    push rsi
    movzx rsi, dl
    rdmsr
    sal rdx, 32
    or rax, rdx
    pop rsi
    ret
GetPState ENDP

;------------------------------------------------------------------------------
; UINTN
; EFIAPI
; EfiReadCr4 (
;   VOID
;   );
;------------------------------------------------------------------------------
EfiReadCr4  PROC
    mov     rax, cr4
    ret
EfiReadCr4  ENDP

;------------------------------------------------------------------------------
; UINTN
; EFIAPI
; EfiWriteCr4 (
;   UINTN  Cr4
;   );
;------------------------------------------------------------------------------
EfiWriteCr4 PROC
    mov     cr4, rcx
    mov     rax, rcx
    ret
EfiWriteCr4 ENDP

END